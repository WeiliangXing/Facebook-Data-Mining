x = 2:1:19;

p = [0.05; 0.1; 0.2; 0.3; 0.4; 0.5; 0.6];

all = [nchoosek(100, 2); nchoosek(100, 3); nchoosek(100, 4); nchoosek(100, 5); nchoosek(100, 6); nchoosek(100, 7); nchoosek(100, 8); nchoosek(100, 9); nchoosek(100, 10); nchoosek(100, 11); nchoosek(100, 12)];

nums = [4904, 157200, 3840000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    4931, 157990, 3420000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    4941, 159901, 3783437, 70605468, 1220703125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    4957, 162581, 3969862, 77298514, 1266298540, 19119813271, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    4956, 162570, 3974520, 77416991, 1256717368, 17553247743, 235922392732, 2117582368135, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    4953, 162039, 3938843, 75920537, 1209787678, 16426907729, 195093520711, 2097318429982, 22517998136852, 360287970189639, 0, 0, 0, 0, 0, 0, 0, 0;
    4952, 161844, 3920979, 75035100, 1179900205, 15660690294, 179005820541, 1790904520695, 15899368546934, 128826547543398, 1008661189502264, 4029326552398618, 0, 0, 0, 0, 0, 0;
    
    ];

costs = [0.000447242259979248, 0.0022397232055664062, 0.0001383519172668457, 7.987022399902344e-07, 3.5047531127929687e-07, 2.0742416381835937e-07, 2.288818359375e-07, 1.8596649169921876e-07, 1.9073486328125e-07, 2.1696090698242188e-07, 2.1219253540039063e-07, 2.0742416381835937e-07, 1.4543533325195312e-07, 2.0265579223632812e-07, 1.5735626220703126e-07, 2.3126602172851562e-07, 1.645088195800781e-07, 2.574920654296875e-07;
    0.0006346464157104492, 0.005633490085601807, 0.0014363813400268554, 2.2628307342529296e-05, 2.9087066650390624e-07, 3.0755996704101563e-07, 2.789497375488281e-07, 2.1219253540039063e-07, 2.4318695068359375e-07, 1.9311904907226564e-07, 1.71661376953125e-07, 2.002716064453125e-07, 2.1696090698242188e-07, 2.0742416381835937e-07, 1.8358230590820313e-07, 2.551078796386719e-07, 2.5033950805664064e-07, 2.193450927734375e-07;
    0.0009095120429992676, 0.013363513946533203, 0.012873876094818115, 0.002520430088043213, 4.562139511108398e-05, 4.506111145019531e-07, 2.980232238769531e-07, 2.002716064453125e-07, 2.3603439331054687e-07, 1.0967254638671875e-07, 2.4318695068359375e-07, 1.8596649169921876e-07, 2.551078796386719e-07, 2.2172927856445314e-07, 2.2411346435546874e-07, 1.9788742065429687e-07, 1.9550323486328124e-07, 2.2172927856445314e-07;
    0.0012180471420288085, 0.02323705196380615, 0.044791250228881835, 0.023007683753967285, 0.0031058406829833985, 9.485960006713867e-05, 9.560585021972656e-07, 1.8835067749023438e-07, 5.14984130859375e-07, 1.430511474609375e-07, 2.0742416381835937e-07, 1.7881393432617188e-07, 2.002716064453125e-07, 2.2649765014648436e-07, 2.6226043701171877e-07, 2.1219253540039063e-07, 1.811981201171875e-07, 1.5735626220703126e-07;
    0.0011380505561828613, 0.02756612777709961, 0.1002579689025879, 0.11784456014633178, 0.04899497985839844, 0.006965069770812988, 0.0003542971611022949, 8.094310760498048e-06, 3.910064697265625e-07, 1.8835067749023438e-07, 2.1457672119140626e-07, 1.5735626220703126e-07, 2.09808349609375e-07, 1.9073486328125e-07, 2.694129943847656e-07, 1.5497207641601563e-07, 2.6226043701171877e-07, 1.4543533325195312e-07;
    0.0012573766708374023, 0.03762486457824707, 0.21604923248291016, 0.5015827822685242, 0.48703057050704956, 0.20782218933105467, 0.03855037927627564, 0.003188488483428955, 0.00012474536895751954, 2.7298927307128905e-06, 2.5033950805664064e-07, 2.0742416381835937e-07, 2.09808349609375e-07, 1.2874603271484376e-07, 2.789497375488281e-07, 1.8835067749023438e-07, 2.3126602172851562e-07, 1.9788742065429687e-07;
    0.001514270305633545, 0.05816201210021973, 0.5021351385116577, 2.0130407762527467, 3.991765232086182, 3.979623866081238, 2.097822411060333, 0.5789297604560852, 0.09094839096069336, 0.007518513202667236, 0.00033664464950561524, 1.0030269622802734e-05, 5.125999450683594e-07, 2.002716064453125e-07, 2.288818359375e-07, 2.4080276489257813e-07, 2.1219253540039063e-07, 1.621246337890625e-07;
    ];

vars = [106058, 2482400000, 231014400000000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    48063, 671709900, 5903600000000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    19799, 207684154, 600380957031, 1786909103393555, 54389238357543945312, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    10598, 101868781, 272179616404, 404680208417802, 607899421071043573, 1827836297749380236154, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    7606, 76893020, 201683700444, 247155238312463, 184804999326806171, 109164059415924788738, 123452109435098395238346, 443931353498101692656112378, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    5155, 50045962, 124126426665, 141032714285875, 94590409109617089, 43672107067993346383, 15925945450437524919524, 5696352681014916391162715, 4073317905264615256528078346, 12850934724873698380612978414820, 0, 0, 0, 0, 0, 0, 0, 0;
    2956, 28760021, 69703339318, 74722614709711, 44988626384054997, 17457780872471932848, 4835652740824603712032, 1056573492045270699346805, 206090262168724774336557849, 41568556571515029778924822661, 8629607017578170140880630350044, 1607311774120589457899606152617753, 0, 0, 0, 0, 0, 0;
    ];

figure(1);
plot(p, [1; 1; 1; 1; 1; 1; 1], p, nums(:, 1) / all(1), p, nums(:, 2) / all(2), p, nums(:, 3) / all(3), p, nums(:, 4) / all(4), p, nums(:, 5) / all(5), p, nums(:, 6) / all(6), p, nums(:, 7) / all(7))
legend('baseline', 'k=2','k=3','k=4','k=5','k=6','k=7','k=8')
xlabel('p')
ylabel('relative rate')
xlim([0.05, 0.6])

figure(2);
plot(p, costs(:, 1), p, costs(:, 2), p, costs(:, 3), p, costs(:, 4), p, costs(:, 5), p, costs(:, 6), p, costs(:, 7))
legend('k=2','k=3','k=4','k=5','k=6','k=7','k=8')
xlabel('p')
ylabel('cost')
xlim([0.05, 0.6])

figure(3);
plot(p, [1; 1; 1; 1; 1; 1; 1], p, sqrt(vars(:, 1)) / all(1), p, sqrt(vars(:, 2)) / all(2), p, sqrt(vars(:, 3)) / all(3), p, sqrt(vars(:, 4)) / all(4), p, sqrt(vars(:, 5)) / all(5), p, sqrt(vars(:, 6)) / all(6), p, sqrt(vars(:, 7)) / all(7))
legend('baseline', 'k=2','k=3','k=4','k=5','k=6','k=7','k=8')
xlabel('p')
ylabel('normalized standard variance')
xlim([0.05, 0.6])
